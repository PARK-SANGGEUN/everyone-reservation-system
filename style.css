<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>예약 | 모두의 예약 시스템</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body data-page="apply">
  <header class="topbar">
    <div class="title-wrap">
      <h1>모두의 예약 시스템</h1>
      <div class="copyright">Copyright@All Teachers</div>
    </div>
    <div class="top-actions">
      <button id="logoutBtn" class="btn ghost">로그아웃</button>
    </div>
  </header>

  <main class="container">

    <section class="card">
      <div class="card-hd">
        <div>
          <h2>예약 페이지</h2>
          <p class="muted">
            이 페이지는 교사가 배부한 링크로만 접근 가능합니다.
            <br/>
            <span class="muted small">교사 코드: <strong id="teacherCodeLabel">-</strong></span>
          </p>
        </div>
        <div class="pill"><span class="login-status">로그인 중…</span></div>
      </div>

      <div class="notice">
        <strong>안내</strong>
        <ul>
          <li>구글 로그인 후 예약 가능합니다.</li>
          <li><strong>1인 1회 예약</strong>만 가능하며, 취소 후 다시 예약할 수 있습니다.</li>
          <li>예약 상태는 실시간 반영됩니다.</li>
        </ul>
      </div>
    </section>

    <!-- 내 예약(1인 1회) -->
    <section class="card">
      <div class="card-hd">
        <div>
          <h2>내 예약</h2>
          <p class="muted">현재 로그인 계정 기준으로 1개 예약만 유지됩니다.</p>
        </div>
        <div class="row gap">
          <button id="cancelMyBtn" class="btn danger">내 예약 취소</button>
        </div>
      </div>

      <div id="myReservationBox" class="myres muted center">예약 정보를 불러오는 중…</div>
    </section>

    <!-- 월 달력 -->
    <section class="card">
      <div class="card-hd">
        <div>
          <h2>월별 예약 달력</h2>
          <div class="legend">
            <span class="dot green"></span> 예약 가능
            <span class="dot red"></span> 마감
            <span class="dot gray"></span> 슬롯 없음
          </div>
        </div>

        <div class="cal-nav">
          <button id="prevMonthBtn" class="btn ghost">◀</button>
          <div id="monthLabel" class="month-label">-</div>
          <button id="nextMonthBtn" class="btn ghost">▶</button>
        </div>
      </div>

      <div id="monthCalendar" class="calendar"></div>
    </section>

    <!-- 날짜별 슬롯 -->
    <section class="card">
      <div class="card-hd">
        <div>
          <h2>예약 가능 시간</h2>
          <p class="muted">달력에서 날짜를 클릭하면 해당 날짜의 슬롯이 표시됩니다.</p>
        </div>
      </div>

      <div class="row gap">
        <div class="selected-date">
          <strong>선택 날짜:</strong> <span id="selectedDateLabel">-</span>
        </div>
      </div>

      <div id="slotsList" class="slots-list muted center">
        날짜를 선택하면 시간 슬롯이 표시됩니다.
      </div>
    </section>

    <!-- 예약 폼 -->
    <section class="card">
      <div class="card-hd">
        <div>
          <h2>예약 정보 입력</h2>
          <p class="muted">시간 슬롯을 선택한 후 아래 정보를 입력하고 예약하세요.</p>
        </div>
      </div>

      <div class="form-grid">
        <label class="label">
          구분
          <select id="roleSelect" class="input">
            <option value="student">학생</option>
            <option value="parent">학부모</option>
          </select>
        </label>

        <label class="label">
          이름(학생/학부모)
          <input id="nameInput" class="input" type="text" placeholder="이름" />
        </label>

        <label class="label role-student">
          학번
          <input id="studentIdInput" class="input" type="text" placeholder="학번" />
        </label>

        <label class="label role-parent" style="display:none;">
          자녀 이름
          <input id="childNameInput" class="input" type="text" placeholder="자녀 이름" />
        </label>

        <label class="label">
          전화번호
          <input id="phoneInput" class="input" type="tel" placeholder="010-0000-0000" />
        </label>

        <div class="row gap">
          <div class="picked-slot">
            <strong>선택 슬롯:</strong> <span id="pickedSlotLabel">-</span>
          </div>
        </div>

        <div class="row gap">
          <button id="bookBtn" class="btn primary">예약 확정</button>
        </div>

        <div id="msgBox" class="msg muted center"></div>
      </div>
    </section>

  </main>

  <!-- Firebase compat SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script src="app.js"></script>
</body>
</html>
