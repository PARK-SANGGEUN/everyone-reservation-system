<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>교사용 | 모두의 예약 시스템</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body data-page="teacher">
  <header class="topbar">
    <div class="title-wrap">
      <h1>모두의 예약 시스템</h1>
      <div class="copyright">Copyright@All Teachers</div>
    </div>
    <div class="top-actions">
      <button id="logoutBtn" class="btn ghost">로그아웃</button>
    </div>
  </header>

  <main class="container">

    <!-- 교사 전용 링크 -->
    <section class="card">
      <div class="card-hd">
        <div>
          <h2>교사 전용 링크</h2>
          <p class="muted">학생·학부모에게 아래 링크(또는 QR)를 배부하세요. 이 링크로만 예약이 가능합니다.</p>
        </div>
        <div class="pill">
          <span class="login-status">로그인 중…</span>
        </div>
      </div>

      <div class="row gap">
        <input id="teacherLink" class="input" type="text" readonly placeholder="로그인 후 자동 생성됩니다." />
        <button id="copyLinkBtn" class="btn primary">링크 복사</button>
        <button id="exportAllBtn" class="btn">상담현황 엑셀 다운로드</button>
      </div>

      <p class="muted small center">※ QR은 링크와 동일합니다(필요 시 QR 생성 기능 추가 가능).</p>
    </section>

    <!-- 슬롯 생성 -->
    <section class="card">
      <div class="card-hd">
        <div>
          <h2>상담 가능 시간 등록</h2>
          <p class="muted">날짜 선택 후 1시간 단위로 체크 → 등록. (중복 슬롯은 자동으로 건너뜁니다)</p>
        </div>
      </div>

      <div class="slot-maker">
        <div class="row gap">
          <label class="label">
            날짜
            <input id="slotDate" type="date" class="input" />
          </label>
          <button id="createSlotsBtn" class="btn primary">선택 시간 슬롯 등록</button>
        </div>

        <div class="hours-grid" id="hoursGrid">
          <!-- JS로 09~18 생성 -->
        </div>
      </div>
    </section>

    <!-- 월별 달력 -->
    <section class="card">
      <div class="card-hd">
        <div>
          <h2>월별 예약 달력</h2>
          <div class="legend">
            <span class="dot green"></span> 예약 가능
            <span class="dot red"></span> 마감
            <span class="dot gray"></span> 슬롯 없음
          </div>
        </div>

        <div class="cal-nav">
          <button id="prevMonthBtn" class="btn ghost">◀</button>
          <div id="monthLabel" class="month-label">-</div>
          <button id="nextMonthBtn" class="btn ghost">▶</button>
        </div>
      </div>

      <div id="monthCalendar" class="calendar"></div>
    </section>

    <!-- 날짜별 슬롯/예약 현황 -->
    <section class="card">
      <div class="card-hd">
        <div>
          <h2>예약 현황</h2>
          <p class="muted">달력에서 날짜를 클릭하면 해당 날짜의 슬롯 및 예약 정보를 확인합니다.</p>
        </div>
        <div class="row gap">
          <button id="exportDayBtn" class="btn">선택 날짜 엑셀 다운로드</button>
        </div>
      </div>

      <div class="row gap">
        <div class="selected-date">
          <strong>선택 날짜:</strong> <span id="selectedDateLabel">-</span>
        </div>
      </div>

      <div class="table-wrap">
        <table class="table">
          <thead>
            <tr>
              <th>시간</th>
              <th>상태</th>
              <th>구분</th>
              <th>이름</th>
              <th>학번/자녀</th>
              <th>연락처</th>
            </tr>
          </thead>
          <tbody id="teacherDayTbody">
            <tr><td colspan="6" class="muted center">날짜를 선택하면 예약 현황이 표시됩니다.</td></tr>
          </tbody>
        </table>
      </div>
    </section>

  </main>

  <!-- Firebase compat SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script src="app.js"></script>
</body>
</html>
